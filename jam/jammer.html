<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href='https://fonts.googleapis.com/css?family=Outfit' rel='stylesheet'>
<style>
html {
    font-family: 'Outfit';
}

.outfit {
	font-family: 'Outfit';
}
#garden {
  background-color: #7a5132;
}

.plot {
	background-image: url("https://raw.githubusercontent.com/Fc500/Fc500.github.io/main/jam/berries/dirt.png");
    background-size: cover;
    text-align: center;
    
}

section {
	background-color: #e6e1e1;
    float: left;
    display: block;
    width: 95%;
margin: 1%;
  	padding: 1%;
}

#notification-box {
    width: 100%;
    text-align: center;
    position: absolute;
    bottom: 10px;
    height: 0;
  	padding: 0px;
    overflow-x: hidden;
    overflow-y: auto;
}

.notif {
	display: block;
    color: white;
    font-size: 10px;
    width: 90%;
    margin-left: 3%;
    margin-bottom: 10px;
    border: 10px solid transparent;
  	border-image: url("https://raw.githubusercontent.com/Fc500/Fc500.github.io/main/jam/berries/border_1.png") 20% stretch;
    background-image: url("https://raw.githubusercontent.com/Fc500/Fc500.github.io/main/jam/berries/background_1.png");
    background-size: cover;
}

.stylized_button {
	background-color:#768d87;
	border-radius:15px;
	border:4px solid #566963;
	display:inline-block;
	cursor:pointer;
	color:#ffffff;
	font-size:15px;
	font-weight:bold;
	padding:12px 20px;
}
.stylized_button:hover {
	background-color:#6c7c7c;
}
.stylized_button:active {
	position:relative;
	top:1px;
}

.navbar {
	background-color: #e6e1e1;
    margin-left: 1%;
    width: 70%;
    padding: 5px;
}

.accordion {
  background-color: #eee;
  color: #444;
  cursor: pointer;
  padding: 18px;
  width: 100%;
  text-align: left;
  border: none;
  outline: none;
  transition: 0.4s;
}

/* Add a background color to the button if it is clicked on (add the .active class with JS), and when you move the mouse over it (hover) */
.active, .accordion:hover {
  background-color: #ccc;
}

.accordion:after {
  content: '\02795'; /* Unicode character for "plus" sign (+) */
  font-size: 13px;
  color: #777;
  float: right;
  margin-left: 5px;
}

.active:after {
  content: "\2796"; /* Unicode character for "minus" sign (-) */
}

/* Style the accordion panel. Note: hidden by default */
.panel {
  padding: 0 18px;
  background-color: white;
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.2s ease-out;
}

.half-section {
	background-color: #eee;
    display: block;
    float: left;
    width: 45%;
    height: 250px;
    margin: 1%;
    padding: 1%;
    overflow-x: hidden;
    overflow-y: auto;
}


/* Style The Dropdown Button */
.dropbtn {
  background-color: #768d87;
  border-radius:15px;
  border: 4px solid #566963;
  color: white;
  padding: 16px;
font-size: 16px;
  cursor: pointer;
}

/* The container <div> - needed to position the dropdown content */
.dropdown {
  position: relative;
  display: inline-block;
}

/* Dropdown Content (Hidden by Default) */
.dropdown-content {
  margin-top: 1%;
  display: none;
  position: absolute;
  background-color: #f9f9f9;
  border-radius: 5px;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

/* Links inside the dropdown */
.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}


/* Change color of dropdown links on hover */
.dropdown-content a:hover {background-color: #f1f1f1}

/* Show the dropdown menu on hover */
.dropdown:hover .dropdown-content {
  display: block;
}

/* Change the background color of the dropdown button when the dropdown content is shown */
.dropdown:hover .dropbtn {
  background-color: #6c7c7c;
}

.block-image {
	background-color: #eddbbb;
    width: 75%;
    border: 3px solid black;
    display: block;
    margin-left: auto;
    margin-right: auto;
}

</style>
</head>
<body>
<h2>Money: <span id="moneyDisp">$500</span></h2>
<div class="navbar">
<button onclick="switchFunction(0)" class="stylized_button">Garden</button>
<button onclick="switchFunction(1)" class="stylized_button">Stock</button>
<button onclick="switchFunction(2)" class="stylized_button">Market</button>
</div>

<section>
<h3>Garden</h3>
<label for="berry-selector">Choose a berry:</label>
<select name="berry-selector" id="berry-selector">
  <option value="bulb">Bulb</option>
  <option value="bliss">Bliss</option>
  <option value="crin">Crin</option>
  <option value="rack">Rack</option>

</select>
<table id="garden"></table>
</section>

<section style="display: none">
<h3>Stock</h3>

<button class="accordion">Bulb Berry</button>
<div class="panel">
  <p>Amount: <b><span id="bulb-berr-disp">0</span></b></p>
  <p>Seeds: <b><span id="bulb-berr-seed">0</span></b></p>

</div>
<button class="accordion">Bliss Berry</button>
<div class="panel">
  <p>Amount: <b><span id="bliss-berr-disp">0</span></b></p>
  <p>Seeds: <b><span id="bliss-berr-seed">0</span></b></p>

</div>

<button class="accordion">Crin Berry</button>
<div class="panel">
  <p>Amount: <b><span id="crin-berr-disp">0</span></b></p>
  <p>Seeds: <b><span id="crin-berr-seed">0</span></b></p>

</div>

<button class="accordion">Rack Berry</button>
<div class="panel">
  <p>Amount: <b><span id="rack-berr-disp">0</span></b></p>
  <p>Seeds: <b><span id="rack-berr-seed">0</span></b></p>
</div>



</section>

<section style="display: none">
	<h3>BUY</h3>
	<div class="half-section">
    <h3>Seeds</h3>
<div style="width: 44%; display: block; float: left; margin: 2%;">
    <img src="https://raw.githubusercontent.com/Fc500/Fc500.github.io/main/jam/berries/bulb.png" class="block-image">  
	<button class="block-image outfit" onclick="buySeed('bulb')">Purchase</button>
	</div> 
    <div style="width: 44%; display: block; float: left; margin: 2%;">
    <img src="https://raw.githubusercontent.com/Fc500/Fc500.github.io/main/jam/berries/bliss.png" class="block-image">
    <button class="block-image outfit" onclick="buySeed('bliss')">Purchase</button>
    </div>
    </div>
   
    
    <div class="half-section">
    <h3>Sell</h3>
    <h4>Sell Product</h4>
    <button>Sell Bulb Berry</button>
    </div>

</section>

<div id="notification-box">
<p id="notification-counter"></p>
</div>

<!-- 
<div class="dropdown">
        <button class="dropbtn">Dropdown</button>
        <div class="dropdown-content">
          <a href="#">Link 1</a>
          <a href="#">Link 2</a>
          <a href="#">Link 3</a>
        </div>
      </div>
-->
</body>
<script>
let money = 500;

const moneyDisp = document.getElementById("moneyDisp");

const berrySelector = document.getElementById("berry-selector");

const notifDisp = document.getElementById("notification-box");
const notifCounter = document.getElementById("notification-counter");
let notifsActive = 0;
let ntf;

let gardenRows;
let gardenPlots = [];
let gardenPlotsIndex = [];
let garden = {
	// Technical stuff
    object: document.getElementById("garden"),
    objectId: "garden",
    
    // Variables
    size: 2,
}

const berries = {
    "bulb": {
        ageOneSprite: "url('https://raw.githubusercontent.com/Fc500/Fc500.github.io/main/jam/berries/bulb_1.png')",
        ageTwoSprite: 
"url('https://raw.githubusercontent.com/Fc500/Fc500.github.io/main/jam/berries/bulb_2.png')",
        ageThreeSprite: "url('https://raw.githubusercontent.com/Fc500/Fc500.github.io/main/jam/berries/bulb_3.png')",
        ageFourSprite: "url('https://raw.githubusercontent.com/Fc500/Fc500.github.io/main/jam/berries/bulb_4.png')",
        ageFiveSprite: "url('https://raw.githubusercontent.com/Fc500/Fc500.github.io/main/jam/berries/bulb_5.png')",
        
        price: 10,
        amount: 0,
        seedAmount: 0,
        saDisp: document.getElementById("bulb-berr-seed"),
        amountDisp: document.getElementById("bulb-berr-disp"),
    	
    },
    
    "bliss": {
    	ageOneSprite: "url('https://raw.githubusercontent.com/Fc500/Fc500.github.io/main/jam/berries/bliss_1.png')",
        ageTwoSprite: "url('https://raw.githubusercontent.com/Fc500/Fc500.github.io/main/jam/berries/bliss_2.png')",
        ageThreeSprite: "url('https://raw.githubusercontent.com/Fc500/Fc500.github.io/main/jam/berries/bliss_3.png')",
        ageFourSprite: "url('https://raw.githubusercontent.com/Fc500/Fc500.github.io/main/jam/berries/bliss_4.png')",
        ageFiveSprite: "url('https://raw.githubusercontent.com/Fc500/Fc500.github.io/main/jam/berries/bliss_5.png')",
        price: 50,
        amount: 0,
seedAmount: 0,
        saDisp: document.getElementById("bliss-berr-seed"),
        amountDisp: document.getElementById("bliss-berr-disp"),
    
    },
    
    "crin": {
    	price: 100,
        amount: 0,
        seedAmount: 0,
    	amountDisp: document.getElementById("crin-berr-disp"),
    
    },
    
    "rack": {
    	price: 500,
        amount: 0,
        seedAmount: 0,
    	amountDisp: document.getElementById("rack-berr-disp"),
    
    },
}

// Currency formatter

let moneyFormatter = new Intl.NumberFormat('en-US', {
    style: 'currency',
    currency: 'USD',
    notation: 'compact',
});

window.onload = function loading() {
    makePlots(garden.size);
    window.alert("v0.45");
    
    var acc = document.getElementsByClassName("accordion");
var i;

for (i = 0; i < acc.length; i++) {
  acc[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var panel = this.nextElementSibling;
    if (panel.style.maxHeight) {
      panel.style.maxHeight = null;
    } else {
      panel.style.maxHeight = panel.scrollHeight + "px";
    } 
  });
}
}

function switchFunction(chosenSection) {
    let sections = document.getElementsByTagName("section");
for (let i = 0; i < sections.length; i++) {
        sections[i].style.display = "none";     
    } 
    sections[chosenSection].style.display = "block";
  } 

function generateNotif(header, text) {
notifsActive++;

	notifDisp.innerHTML += `<div class="notif" onclick="this.remove(); removeNotif();">
    	<h3>${header}</h3>
    	<p>${text}</p>
    	</div>`;
    
    
    
    if (notifsActive < 4) {
    
    ntf = notifsActive * 60;
    
    notifDisp.style.height = `${ntf}px`;
    
    } else {
    
    notifCounter.innerHTML =  `${notifsActive} notifs`;
    
    }

}

function removeNotif() {
	let shortHand = notifDisp.offsetHeight;
    notifsActive -= 1;
    
  	if (notifsActive < 3) {
    	shortHand -= 60;
notifDisp.style.height = shortHand + 'px';
    }
 
    if (notifDisp.style.height == undefined) {
    	notifDisp.style.height = "0px";
    }
}

function setUpGarden() {
	switch (garden.size) {
		case 1: 
			garden.object.style.width = "100px";
    		garden.object.style.height = "100px";
    		break;
        case 2:
        	garden.object.style.width = "250px";
    		garden.object.style.height = "250px";
        	break;
        case 3:
        	garden.object.style.width = "500px";
    		garden.object.style.height = "500px";
        	break;
       case 4:
        	garden.object.style.width = "750px";
    		garden.object.style.height = "750px";
        	break;
	}
}
function makePlots(size) {
let arrayIndex = 0;
	for (let i = 0; i < size * 2; i++) {
    	let gardenPlotRow = document.createElement("tr");
gardenPlotRow.setAttribute("id", i);
        for (let j = 0; j < size * 2; j++) {
            
            let gpId = Math.floor(Math.random() * 9999);
            gardenPlotRow.innerHTML += `<td class='plot' id='${gpId}' onclick='makePlant(${arrayIndex}, this)'></td>`
            //${gpId} | ${arrayIndex}</td>`;
            gardenPlotsIndex.push(arrayIndex);
            
            
            let plant = {
    			id: gpId,
        		arrayId: arrayIndex,
        		age: -1,
        		type: "none",
                price: 0,
    		} 
    
    		gardenPlots.push(plant);
            
            arrayIndex++;
		}
        garden.object.appendChild(gardenPlotRow);
	}  
    setUpGarden();
gardenRows = document.getElementById("garden").rows;   
}



function makePlant(arrayInd, cell) {

	let plot = gardenPlots[arrayInd];
    
    if (plot.age >= 0) {
        harvestPlants(plot);
    } else {
    let chosenBerry = berrySelector.value;
    
    if (berries[chosenBerry].seedAmount > 0) {
    
    berries[chosenBerry].seedAmount -= 1;
    berries[chosenBerry].saDisp.innerHTML = berries[chosenBerry].seedAmount;
    
		let text = "A " + chosenBerry + " berry was planted in plot " + arrayInd;
    	plot.age = 0;
    	plot.type = chosenBerry;
        
    	cell.style.backgroundSize = "cover";
    //window.alert("Plant Index: " + gardenPlotsIndex);
    //window.alert("Plant Objects: " + gardenPlots);
    
    generateNotif("Berry planted!", text);
    } else {
    	generateNotif("Warning!", "Not enough seeds to plant!");
    }  
    }
}

function harvestPlants(selectedPlot) {

	if (selectedPlot.age >= 5) {
        selectedPlot.age = -1;
        berries[selectedPlot.type].amount++;
        console.log(berries[selectedPlot.type].amount);
        document.getElementById(selectedPlot.id).style.backgroundImage = "url('https://raw.githubusercontent.com/Fc500/Fc500.github.io/main/jam/berries/dirt.png')";
        
        berries[selectedPlot.type].amountDisp.innerHTML = berries[selectedPlot.type].amount;
        
    } else {
    	console.log("Berry is not ready to be harvested!");
    }

}

function checkPlants() {
	for (let i = 0; i < gardenPlotsIndex.length; i++) {
    	let plot = gardenPlots[i];
        // Plant logic  
        if (plot.age > -1) {
        plot.age++;
switch (plot.age) {
            	case 1: 
document.getElementById(plot.id).style.backgroundImage = berries[plot.type].ageOneSprite;
				generateNotif("Plant found!", `Plant found in plot ${plot.arrayId}`);
				break;
                
				case 2:        
                	document.getElementById(plot.id).style.backgroundImage = berries[plot.type].ageTwoSprite;
                break;
                
                case 3:       
                	document.getElementById(plot.id).style.backgroundImage = berries[plot.type].ageThreeSprite;	
		break;
                
                case 4:      
                	document.getElementById(plot.id).style.backgroundImage = berries[plot.type].ageFourSprite;	
                break;
                
                case 5:      
                	document.getElementById(plot.id).style.backgroundImage = berries[plot.type].ageFiveSprite;
	      break;
				case 6:   
document.getElementById(plot.id).style.backgroundImage = berries[plot.type].ageFourSprite;	
                break;
                
                case 7:    
                	document.getElementById(plot.id).style.backgroundImage = berries[plot.type].ageThreeSprite;
                break;
case 8:
                generateNotif("Warning!", "A plant has died in plot " + plot.arrayId);
                document.getElementById(plot.id).style.backgroundImage = "url('https://raw.githubusercontent.com/Fc500/Fc500.github.io/main/jam/berries/dirt.png')";
                plot.age = -1;
            } 
 		}
        
    }
}

function buySeed(seed) {
	let berry = berries[seed];
	if (money >= berry.price) {
    	money -= berry.price;
        moneyDisp.innerHTML = moneyFormatter.format(money);
        berry.seedAmount++;
        berry.saDisp.innerHTML = berry.seedAmount;
    }	
}

function sellProduct() {

}

function checkMoney() {
moneyDisp.innerHTML = moneyFormatter.format(money);
    
}

function updateNotif() {
    
    let notifsList = notifDisp.children; 
    notifsList[1].remove();
    removeNotif();
    
    
}
let checkPlantTimer = setInterval(checkPlants, 5000);
let checkMoneyTimer = setInterval(checkMoney, 1000);
let fhwyegu = setInterval(updateNotif, 10000);
</script>
</html> 
